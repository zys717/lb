{
  "scenario": "S008",
  "summary": {
    "total_test_cases": 4,
    "llm_calls": 4,
    "llm_accuracy": "4/4",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1",
      "description": "远离建筑物超全局限制",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 3000.0,
          "y": 0.0,
          "z": 150.0
        },
        "altitude_m": 150.0,
        "structure_eval": [
          {
            "id": "building_1",
            "distance": 2236.07,
            "waiver_radius": 121.92,
            "waiver_limit": 221.92,
            "global_limit": 120.0,
            "status": "outside",
            "applied_limit": 120.0
          }
        ],
        "altitude_eval": {
          "mission_altitude": 150.0,
          "limit": 120.0,
          "status": "VIOLATION"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\nStructure waiver checks (pre-computed):\n  - building_1: distance=2236.07m, waiver_radius=121.92m, global_limit=120.0m, waiver_limit=221.92m => status=outside\nStructure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT. Do NOT answer UNCERTAIN when structure_eval is present.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 3000.0, \"y\": 0.0, \"z\": 150.0}, \"altitude_m\": 150.0, \"structure_eval\": [{\"id\": \"building_1\", \"distance\": 2236.07, \"waiver_radius\": 121.92, \"waiver_limit\": 221.92, \"global_limit\": 120.0, \"status\": \"outside\", \"applied_limit\": 120.0}], \"altitude_eval\": {\"mission_altitude\": 150.0, \"limit\": 120.0, \"status\": \"VIOLATION\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission altitude of 150.0m exceeds the global altitude limit of 120.0m.\",\n    \"The altitude auto-check resulted in a VIOLATION status, which by hard rule mandates a REJECT decision.\"\n  ],\n  \"citations\": [\n    \"Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\",\n    \"Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\",\n    \"Structure waiver rule (hard constraint): Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission altitude of 150.0m exceeds the global altitude limit of 120.0m.",
          "The altitude auto-check resulted in a VIOLATION status, which by hard rule mandates a REJECT decision."
        ],
        "citations": [
          "Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.",
          "Altitude: 120.0m (SOP S008_structure_waiver.jsonc)",
          "Structure waiver rule (hard constraint): Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S008_structure_waiver.jsonc",
          "raw_value": "120.0",
          "raw_unit": "m",
          "canonical_value": "120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S008_structure_waiver.jsonc",
          "constraint_id": "S008_structure_waiver_scenario_parameters_global_altitude_limit_agl"
        }
      ]
    },
    {
      "test_case_id": "TC2",
      "description": "建筑物豁免区内合规高度",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 1000.0,
          "y": 1100.0,
          "z": 150.0
        },
        "altitude_m": 150.0,
        "structure_eval": [
          {
            "id": "building_1",
            "distance": 100.0,
            "waiver_radius": 121.92,
            "waiver_limit": 221.92,
            "global_limit": 120.0,
            "status": "inside",
            "applied_limit": 221.92
          }
        ],
        "altitude_eval": {
          "mission_altitude": 150.0,
          "limit": 221.92,
          "status": "OK"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\nStructure waiver checks (pre-computed):\n  - building_1: distance=100.0m, waiver_radius=121.92m, global_limit=120.0m, waiver_limit=221.92m => status=inside\nStructure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT. Do NOT answer UNCERTAIN when structure_eval is present.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Altitude check: mission_altitude=150.0 m vs limit=221.92 m -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 1000.0, \"y\": 1100.0, \"z\": 150.0}, \"altitude_m\": 150.0, \"structure_eval\": [{\"id\": \"building_1\", \"distance\": 100.0, \"waiver_radius\": 121.92, \"waiver_limit\": 221.92, \"global_limit\": 120.0, \"status\": \"inside\", \"applied_limit\": 221.92}], \"altitude_eval\": {\"mission_altitude\": 150.0, \"limit\": 221.92, \"status\": \"OK\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"The mission altitude (150.0m) is below the applied altitude limit (221.92m), which was set by the structure waiver for building_1.\",\n    \"All auto-checks passed; specifically, the altitude check status is OK.\",\n    \"Geofence checks are considered outside by default as no specific constraints were provided.\"\n  ],\n  \"citations\": [\n    \"SOP S008_structure_waiver.jsonc (for structure waiver rule: using waiver_limit of 221.92m for building_1 as mission is inside waiver radius)\",\n    \"Mission Altitude Check (mission_altitude=150.0 m vs limit=221.92 m -> OK)\",\n    \"Hard rules (criteria for APPROVE: all auto_check statuses are OK and geofence checks are outside)\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "The mission altitude (150.0m) is below the applied altitude limit (221.92m), which was set by the structure waiver for building_1.",
          "All auto-checks passed; specifically, the altitude check status is OK.",
          "Geofence checks are considered outside by default as no specific constraints were provided."
        ],
        "citations": [
          "SOP S008_structure_waiver.jsonc (for structure waiver rule: using waiver_limit of 221.92m for building_1 as mission is inside waiver radius)",
          "Mission Altitude Check (mission_altitude=150.0 m vs limit=221.92 m -> OK)",
          "Hard rules (criteria for APPROVE: all auto_check statuses are OK and geofence checks are outside)"
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S008_structure_waiver.jsonc",
          "raw_value": "120.0",
          "raw_unit": "m",
          "canonical_value": "120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S008_structure_waiver.jsonc",
          "constraint_id": "S008_structure_waiver_scenario_parameters_global_altitude_limit_agl"
        }
      ]
    },
    {
      "test_case_id": "TC3",
      "description": "建筑物豁免区内超豁免上限",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 1000.0,
          "y": 1100.0,
          "z": 230.0
        },
        "altitude_m": 230.0,
        "structure_eval": [
          {
            "id": "building_1",
            "distance": 100.0,
            "waiver_radius": 121.92,
            "waiver_limit": 221.92,
            "global_limit": 120.0,
            "status": "inside",
            "applied_limit": 221.92
          }
        ],
        "altitude_eval": {
          "mission_altitude": 230.0,
          "limit": 221.92,
          "status": "VIOLATION"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\nStructure waiver checks (pre-computed):\n  - building_1: distance=100.0m, waiver_radius=121.92m, global_limit=120.0m, waiver_limit=221.92m => status=inside\nStructure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT. Do NOT answer UNCERTAIN when structure_eval is present.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Altitude check: mission_altitude=230.0 m vs limit=221.92 m -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 1000.0, \"y\": 1100.0, \"z\": 230.0}, \"altitude_m\": 230.0, \"structure_eval\": [{\"id\": \"building_1\", \"distance\": 100.0, \"waiver_radius\": 121.92, \"waiver_limit\": 221.92, \"global_limit\": 120.0, \"status\": \"inside\", \"applied_limit\": 221.92}], \"altitude_eval\": {\"mission_altitude\": 230.0, \"limit\": 221.92, \"status\": \"VIOLATION\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission altitude (230.0m) exceeds the dynamically computed altitude limit (221.92m) for building_1, which is determined by the structure waiver rule.\",\n    \"The altitude auto_check resulted in a VIOLATION status, which is a hard rule for rejection.\"\n  ],\n  \"citations\": [\n    \"Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\",\n    \"Structure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. (230.0m >= 221.92m)\",\n    \"Auto checks: Altitude check: mission_altitude=230.0 m vs limit=221.92 m -> VIOLATION.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission altitude (230.0m) exceeds the dynamically computed altitude limit (221.92m) for building_1, which is determined by the structure waiver rule.",
          "The altitude auto_check resulted in a VIOLATION status, which is a hard rule for rejection."
        ],
        "citations": [
          "Altitude: 120.0m (SOP S008_structure_waiver.jsonc)",
          "Structure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. (230.0m >= 221.92m)",
          "Auto checks: Altitude check: mission_altitude=230.0 m vs limit=221.92 m -> VIOLATION.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S008_structure_waiver.jsonc",
          "raw_value": "120.0",
          "raw_unit": "m",
          "canonical_value": "120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S008_structure_waiver.jsonc",
          "constraint_id": "S008_structure_waiver_scenario_parameters_global_altitude_limit_agl"
        }
      ]
    },
    {
      "test_case_id": "TC4",
      "description": "豁免半径边界测试",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 1122.0,
          "y": 1000.0,
          "z": 150.0
        },
        "altitude_m": 150.0,
        "structure_eval": [
          {
            "id": "building_1",
            "distance": 122.0,
            "waiver_radius": 121.92,
            "waiver_limit": 221.92,
            "global_limit": 120.0,
            "status": "outside",
            "applied_limit": 120.0
          }
        ],
        "altitude_eval": {
          "mission_altitude": 150.0,
          "limit": 120.0,
          "status": "VIOLATION"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\nStructure waiver checks (pre-computed):\n  - building_1: distance=122.0m, waiver_radius=121.92m, global_limit=120.0m, waiver_limit=221.92m => status=outside\nStructure waiver rule (hard constraint): inside waiver radius => use waiver_limit; altitude >= waiver_limit -> REJECT. Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT. Do NOT answer UNCERTAIN when structure_eval is present.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 1122.0, \"y\": 1000.0, \"z\": 150.0}, \"altitude_m\": 150.0, \"structure_eval\": [{\"id\": \"building_1\", \"distance\": 122.0, \"waiver_radius\": 121.92, \"waiver_limit\": 221.92, \"global_limit\": 120.0, \"status\": \"outside\", \"applied_limit\": 120.0}], \"altitude_eval\": {\"mission_altitude\": 150.0, \"limit\": 120.0, \"status\": \"VIOLATION\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission altitude (150.0m) exceeds the global altitude limit (120.0m).\",\n    \"The auto_check for altitude is in VIOLATION (150.0m vs 120.0m limit), which is a hard reject condition.\"\n  ],\n  \"citations\": [\n    \"Altitude: 120.0m (SOP S008_structure_waiver.jsonc)\",\n    \"Structure waiver rule (hard constraint): Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT.\",\n    \"Auto checks: - Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission altitude (150.0m) exceeds the global altitude limit (120.0m).",
          "The auto_check for altitude is in VIOLATION (150.0m vs 120.0m limit), which is a hard reject condition."
        ],
        "citations": [
          "Altitude: 120.0m (SOP S008_structure_waiver.jsonc)",
          "Structure waiver rule (hard constraint): Outside waiver radius => use global_limit; altitude >= global_limit -> REJECT.",
          "Auto checks: - Altitude check: mission_altitude=150.0 m vs limit=120.0 m -> VIOLATION.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S008_structure_waiver.jsonc",
          "raw_value": "120.0",
          "raw_unit": "m",
          "canonical_value": "120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S008_structure_waiver.jsonc",
          "constraint_id": "S008_structure_waiver_scenario_parameters_global_altitude_limit_agl"
        }
      ]
    }
  ]
}