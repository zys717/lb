{
  "scenario": "S015",
  "summary": {
    "total_test_cases": 6,
    "llm_calls": 6,
    "llm_accuracy": "6/6",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1_PathBlocked_FrontNFZ",
      "description": "路径前方有禁飞区 - 应在Pre-flight检测并拒绝",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 800.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 800.0,
            "end_y": 0.0,
            "min_distance": 12.4,
            "threshold": 300.0,
            "status": "inside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 800.0,
            "end_y": 0.0,
            "min_distance": 1064.19,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 800.0,
            "end_y": 0.0,
            "min_distance": 1700.74,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 304.14,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 1064.19,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 1700.74,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "APPROVE"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=304.14m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=1064.19m (3D), threshold=400.0m => status=outside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=1700.74m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(800.0,0.0), min_distance=12.4m, threshold=300.0m => status=inside\n  - nfz_police_operation: start=(0.0,0.0), end=(800.0,0.0), min_distance=1064.19m, threshold=400.0m => status=outside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(800.0,0.0), min_distance=1700.74m, threshold=500.0m => status=outside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 800.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 800.0, \"end_y\": 0.0, \"min_distance\": 12.4, \"threshold\": 300.0, \"status\": \"inside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 800.0, \"end_y\": 0.0, \"min_distance\": 1064.19, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 800.0, \"end_y\": 0.0, \"min_distance\": 1700.74, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 304.14, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 1064.19, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 1700.74, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"APPROVE\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission's planned path crosses a no-fly zone designated for emergency landing operations, which is a violation of the path crossing rule.\"\n  ],\n  \"citations\": [\n    \"Path crossing rule: if ANY path_eval status == inside, decision MUST be REJECT.\",\n    \"Mission path_eval for 'nfz_emergency_landing' has status: 'inside'.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission's planned path crosses a no-fly zone designated for emergency landing operations, which is a violation of the path crossing rule."
        ],
        "citations": [
          "Path crossing rule: if ANY path_eval status == inside, decision MUST be REJECT.",
          "Mission path_eval for 'nfz_emergency_landing' has status: 'inside'."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC2_PathClear_OffsetNFZ",
      "description": "路径旁边有禁飞区但不冲突 - 应批准飞行",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 1000.0,
          "y": 1000.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1000.0,
            "end_y": 1000.0,
            "min_distance": 354.43,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1000.0,
            "end_y": 1000.0,
            "min_distance": 540.83,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1000.0,
            "end_y": 1000.0,
            "min_distance": 1803.47,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 1119.15,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 540.83,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 1803.47,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "APPROVE"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=1119.15m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=540.83m (3D), threshold=400.0m => status=outside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=1803.47m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(1000.0,1000.0), min_distance=354.43m, threshold=300.0m => status=outside\n  - nfz_police_operation: start=(0.0,0.0), end=(1000.0,1000.0), min_distance=540.83m, threshold=400.0m => status=outside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(1000.0,1000.0), min_distance=1803.47m, threshold=500.0m => status=outside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 1000.0, \"y\": 1000.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1000.0, \"end_y\": 1000.0, \"min_distance\": 354.43, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1000.0, \"end_y\": 1000.0, \"min_distance\": 540.83, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1000.0, \"end_y\": 1000.0, \"min_distance\": 1803.47, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 1119.15, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 540.83, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 1803.47, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"APPROVE\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All geofence checks returned a 'outside' status, satisfying the geofence decision rule.\",\n    \"All path crossing checks returned a 'outside' status, satisfying the path crossing rule.\"\n  ],\n  \"citations\": [\n    \"Geofence decision rule: if ALL geofences are outside, decision is APPROVE unless other constraints are violated.\",\n    \"Path crossing rule: if ANY path_eval status == inside, decision MUST be REJECT. (No 'inside' statuses found)\",\n    \"nfz_emergency_landing (geofence): status=outside\",\n    \"nfz_police_operation (geofence): status=outside\",\n    \"nfz_fire_rescue (geofence): status=outside\",\n    \"nfz_emergency_landing (path crossing): status=outside\",\n    \"nfz_police_operation (path crossing): status=outside\",\n    \"nfz_fire_rescue (path crossing): status=outside\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All geofence checks returned a 'outside' status, satisfying the geofence decision rule.",
          "All path crossing checks returned a 'outside' status, satisfying the path crossing rule."
        ],
        "citations": [
          "Geofence decision rule: if ALL geofences are outside, decision is APPROVE unless other constraints are violated.",
          "Path crossing rule: if ANY path_eval status == inside, decision MUST be REJECT. (No 'inside' statuses found)",
          "nfz_emergency_landing (geofence): status=outside",
          "nfz_police_operation (geofence): status=outside",
          "nfz_fire_rescue (geofence): status=outside",
          "nfz_emergency_landing (path crossing): status=outside",
          "nfz_police_operation (path crossing): status=outside",
          "nfz_fire_rescue (path crossing): status=outside"
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC3_MultipleNFZ_BothBlocked",
      "description": "路径穿过多个禁飞区 - 应拒绝（最近的NFZ优先）",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 3000.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 3000.0,
            "end_y": 0.0,
            "min_distance": 33.31,
            "threshold": 300.0,
            "status": "inside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 3000.0,
            "end_y": 0.0,
            "min_distance": 800.0,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 3000.0,
            "end_y": 0.0,
            "min_distance": 33.31,
            "threshold": 500.0,
            "status": "inside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 2500.5,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 1700.74,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 502.49,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "APPROVE"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=2500.5m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=1700.74m (3D), threshold=400.0m => status=outside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=502.49m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(3000.0,0.0), min_distance=33.31m, threshold=300.0m => status=inside\n  - nfz_police_operation: start=(0.0,0.0), end=(3000.0,0.0), min_distance=800.0m, threshold=400.0m => status=outside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(3000.0,0.0), min_distance=33.31m, threshold=500.0m => status=inside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 3000.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 3000.0, \"end_y\": 0.0, \"min_distance\": 33.31, \"threshold\": 300.0, \"status\": \"inside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 3000.0, \"end_y\": 0.0, \"min_distance\": 800.0, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 3000.0, \"end_y\": 0.0, \"min_distance\": 33.31, \"threshold\": 500.0, \"status\": \"inside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 2500.5, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 1700.74, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 502.49, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"APPROVE\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"Mission path crosses multiple no-fly zones.\",\n    \"The path for 'nfz_emergency_landing' is 'inside' its defined threshold.\",\n    \"The path for 'nfz_fire_rescue' is 'inside' its defined threshold.\"\n  ],\n  \"citations\": [\n    \"Path crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT.\",\n    \"nfz_emergency_landing path_eval status=inside\",\n    \"nfz_fire_rescue path_eval status=inside\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "Mission path crosses multiple no-fly zones.",
          "The path for 'nfz_emergency_landing' is 'inside' its defined threshold.",
          "The path for 'nfz_fire_rescue' is 'inside' its defined threshold."
        ],
        "citations": [
          "Path crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT.",
          "nfz_emergency_landing path_eval status=inside",
          "nfz_fire_rescue path_eval status=inside"
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC4_ShortPath_NoConflict",
      "description": "短距离飞行，未到达任何禁飞区 - 应批准",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 150.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 150.0,
            "end_y": 0.0,
            "min_distance": 353.55,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 150.0,
            "end_y": 0.0,
            "min_distance": 1570.03,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 150.0,
            "end_y": 0.0,
            "min_distance": 2350.53,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 353.55,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 1570.03,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 2350.53,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "APPROVE"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=353.55m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=1570.03m (3D), threshold=400.0m => status=outside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=2350.53m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(150.0,0.0), min_distance=353.55m, threshold=300.0m => status=outside\n  - nfz_police_operation: start=(0.0,0.0), end=(150.0,0.0), min_distance=1570.03m, threshold=400.0m => status=outside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(150.0,0.0), min_distance=2350.53m, threshold=500.0m => status=outside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 150.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 150.0, \"end_y\": 0.0, \"min_distance\": 353.55, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 150.0, \"end_y\": 0.0, \"min_distance\": 1570.03, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 150.0, \"end_y\": 0.0, \"min_distance\": 2350.53, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 353.55, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 1570.03, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 2350.53, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"APPROVE\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All geofence checks show a status of 'outside', satisfying the geofence decision rule.\",\n    \"All path crossing checks show a status of 'outside', satisfying the path crossing rule.\",\n    \"No constraints were violated that would require a REJECT decision.\"\n  ],\n  \"citations\": [\n    \"Geofence checks (pre-computed): nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside)\",\n    \"Geofence decision rule (hard constraint): 'If ALL geofences are outside, decision is APPROVE unless other constraints are violated.'\",\n    \"Path crossing checks (pre-computed): nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside)\",\n    \"Path crossing rule (hard constraint): 'if ANY path_eval status == inside, decision MUST be REJECT.' (This condition was not met for rejection).\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All geofence checks show a status of 'outside', satisfying the geofence decision rule.",
          "All path crossing checks show a status of 'outside', satisfying the path crossing rule.",
          "No constraints were violated that would require a REJECT decision."
        ],
        "citations": [
          "Geofence checks (pre-computed): nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside)",
          "Geofence decision rule (hard constraint): 'If ALL geofences are outside, decision is APPROVE unless other constraints are violated.'",
          "Path crossing checks (pre-computed): nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside)",
          "Path crossing rule (hard constraint): 'if ANY path_eval status == inside, decision MUST be REJECT.' (This condition was not met for rejection)."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC5_EdgeCase_NearBoundary",
      "description": "路径刚好贴近禁飞区边界 - 边界测试",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 500.0,
          "y": 400.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 500.0,
            "end_y": 400.0,
            "min_distance": 312.54,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 500.0,
            "end_y": 400.0,
            "min_distance": 1078.19,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 500.0,
            "end_y": 400.0,
            "min_distance": 2040.22,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 403.11,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 1078.19,
            "threshold": 400.0,
            "status": "outside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 2040.22,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "APPROVE"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=403.11m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=1078.19m (3D), threshold=400.0m => status=outside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=2040.22m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(500.0,400.0), min_distance=312.54m, threshold=300.0m => status=outside\n  - nfz_police_operation: start=(0.0,0.0), end=(500.0,400.0), min_distance=1078.19m, threshold=400.0m => status=outside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(500.0,400.0), min_distance=2040.22m, threshold=500.0m => status=outside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 500.0, \"y\": 400.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 500.0, \"end_y\": 400.0, \"min_distance\": 312.54, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 500.0, \"end_y\": 400.0, \"min_distance\": 1078.19, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 500.0, \"end_y\": 400.0, \"min_distance\": 2040.22, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 403.11, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 1078.19, \"threshold\": 400.0, \"status\": \"outside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 2040.22, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"APPROVE\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All geofence checks resulted in 'outside' status, satisfying the geofence decision rule.\",\n    \"All path crossing checks resulted in 'outside' status, satisfying the path crossing rule.\"\n  ],\n  \"citations\": [\n    \"Geofence checks: nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside).\",\n    \"Geofence decision rule: 'if ALL geofences are outside, decision is APPROVE unless other constraints are violated'.\",\n    \"Path crossing checks: nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside).\",\n    \"Path crossing rule: 'if ANY path_eval status == inside, decision MUST be REJECT'. (No path_eval status was 'inside').\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All geofence checks resulted in 'outside' status, satisfying the geofence decision rule.",
          "All path crossing checks resulted in 'outside' status, satisfying the path crossing rule."
        ],
        "citations": [
          "Geofence checks: nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside).",
          "Geofence decision rule: 'if ALL geofences are outside, decision is APPROVE unless other constraints are violated'.",
          "Path crossing checks: nfz_emergency_landing (status=outside), nfz_police_operation (status=outside), nfz_fire_rescue (status=outside).",
          "Path crossing rule: 'if ANY path_eval status == inside, decision MUST be REJECT'. (No path_eval status was 'inside')."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC6_Diagonal_PathConflict",
      "description": "对角线路径冲突测试",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 1500.0,
          "y": 500.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "path_eval": [
          {
            "id": "nfz_emergency_landing",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1500.0,
            "end_y": 500.0,
            "min_distance": 159.37,
            "threshold": 300.0,
            "status": "inside"
          },
          {
            "id": "nfz_police_operation",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1500.0,
            "end_y": 500.0,
            "min_distance": 304.14,
            "threshold": 400.0,
            "status": "inside"
          },
          {
            "id": "nfz_fire_rescue",
            "start_x": 0.0,
            "start_y": 0.0,
            "end_x": 1500.0,
            "end_y": 500.0,
            "min_distance": 1119.15,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_eval": [
          {
            "id": "nfz_emergency_landing",
            "cx": 500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 200.0,
            "margin": 100.0,
            "distance": 1119.15,
            "threshold": 300.0,
            "status": "outside"
          },
          {
            "id": "nfz_police_operation",
            "cx": 1500.0,
            "cy": 800.0,
            "cz": 0.0,
            "radius": 250.0,
            "margin": 150.0,
            "distance": 304.14,
            "threshold": 400.0,
            "status": "inside"
          },
          {
            "id": "nfz_fire_rescue",
            "cx": 2500.0,
            "cy": 0.0,
            "cz": 0.0,
            "radius": 300.0,
            "margin": 200.0,
            "distance": 1119.15,
            "threshold": 500.0,
            "status": "outside"
          }
        ],
        "geofence_recommendation": "REJECT"
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nGeofence checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: center=(500.0,0.0,0.0), radius=200.0m, margin=100.0m, distance=1119.15m (3D), threshold=300.0m => status=outside\n  - nfz_police_operation: center=(1500.0,800.0,0.0), radius=250.0m, margin=150.0m, distance=304.14m (3D), threshold=400.0m => status=inside\n  - nfz_fire_rescue: center=(2500.0,0.0,0.0), radius=300.0m, margin=200.0m, distance=1119.15m (3D), threshold=500.0m => status=outside\nPath crossing checks (pre-computed, use these values directly):\n  - nfz_emergency_landing: start=(0.0,0.0), end=(1500.0,500.0), min_distance=159.37m, threshold=300.0m => status=inside\n  - nfz_police_operation: start=(0.0,0.0), end=(1500.0,500.0), min_distance=304.14m, threshold=400.0m => status=inside\n  - nfz_fire_rescue: start=(0.0,0.0), end=(1500.0,500.0), min_distance=1119.15m, threshold=500.0m => status=outside\nGeofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT. If ALL geofences are outside, decision is APPROVE unless other constraints are violated. Do NOT answer UNCERTAIN when geofence_eval is present.\nPath crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT. Do NOT answer UNCERTAIN when path_eval is present.\nMission: {\"target_xyz\": {\"x\": 1500.0, \"y\": 500.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"path_eval\": [{\"id\": \"nfz_emergency_landing\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1500.0, \"end_y\": 500.0, \"min_distance\": 159.37, \"threshold\": 300.0, \"status\": \"inside\"}, {\"id\": \"nfz_police_operation\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1500.0, \"end_y\": 500.0, \"min_distance\": 304.14, \"threshold\": 400.0, \"status\": \"inside\"}, {\"id\": \"nfz_fire_rescue\", \"start_x\": 0.0, \"start_y\": 0.0, \"end_x\": 1500.0, \"end_y\": 500.0, \"min_distance\": 1119.15, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_eval\": [{\"id\": \"nfz_emergency_landing\", \"cx\": 500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 200.0, \"margin\": 100.0, \"distance\": 1119.15, \"threshold\": 300.0, \"status\": \"outside\"}, {\"id\": \"nfz_police_operation\", \"cx\": 1500.0, \"cy\": 800.0, \"cz\": 0.0, \"radius\": 250.0, \"margin\": 150.0, \"distance\": 304.14, \"threshold\": 400.0, \"status\": \"inside\"}, {\"id\": \"nfz_fire_rescue\", \"cx\": 2500.0, \"cy\": 0.0, \"cz\": 0.0, \"radius\": 300.0, \"margin\": 200.0, \"distance\": 1119.15, \"threshold\": 500.0, \"status\": \"outside\"}], \"geofence_recommendation\": \"REJECT\"}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"Geofence violation: The mission's location is inside the 'nfz_police_operation' geofence (status: inside, distance: 304.14m, threshold: 400.0m).\",\n    \"Path crossing violation: The mission's path crosses the 'nfz_emergency_landing' zone (status: inside, min_distance: 159.37m, threshold: 300.0m).\",\n    \"Path crossing violation: The mission's path crosses the 'nfz_police_operation' zone (status: inside, min_distance: 304.14m, threshold: 400.0m).\"\n  ],\n  \"citations\": [\n    \"Geofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT.\",\n    \"Path crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "Geofence violation: The mission's location is inside the 'nfz_police_operation' geofence (status: inside, distance: 304.14m, threshold: 400.0m).",
          "Path crossing violation: The mission's path crosses the 'nfz_emergency_landing' zone (status: inside, min_distance: 159.37m, threshold: 300.0m).",
          "Path crossing violation: The mission's path crosses the 'nfz_police_operation' zone (status: inside, min_distance: 304.14m, threshold: 400.0m)."
        ],
        "citations": [
          "Geofence decision rule (hard constraint): if ANY geofence status == inside, decision MUST be REJECT.",
          "Path crossing rule (hard constraint): if ANY path_eval status == inside, decision MUST be REJECT."
        ]
      },
      "retrieved_constraints": []
    }
  ]
}