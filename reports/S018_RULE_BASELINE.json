{
  "scenario": "S018",
  "summary": {
    "total_test_cases": 8,
    "llm_calls": 8,
    "llm_accuracy": "8/8",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1_SingleOperatorSingleDrone",
      "description": "基础场景：单操作员控制单架无人机",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "active_drones": [
          "Drone1"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 1
          },
          "status": "OK"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 1} => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\"], \"swarm_mode\": false, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 1}, \"status\": \"OK\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"Operator evaluation status is OK; no operator limit violation.\",\n    \"Swarm mode is false, therefore no swarm approval is required.\",\n    \"No separation evaluation violations were reported.\",\n    \"No geofence constraints were provided, therefore no geofence violation.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks (pre-computed): Operator limit: max_per_operator=1 counts={'OP001': 1} => status=OK\",\n    \"Multi-drone rules: If operator_eval status == VIOLATION (...), decision MUST be REJECT. (Mission operator_eval status is OK)\",\n    \"Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. (Mission swarm_mode is false)\",\n    \"Multi-drone rules: If ANY separation_eval status == VIOLATION (...), decision MUST be REJECT. (No separation_eval status provided, implying no violation)\",\n    \"No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "Operator evaluation status is OK; no operator limit violation.",
          "Swarm mode is false, therefore no swarm approval is required.",
          "No separation evaluation violations were reported.",
          "No geofence constraints were provided, therefore no geofence violation."
        ],
        "citations": [
          "Multi-drone coordination checks (pre-computed): Operator limit: max_per_operator=1 counts={'OP001': 1} => status=OK",
          "Multi-drone rules: If operator_eval status == VIOLATION (...), decision MUST be REJECT. (Mission operator_eval status is OK)",
          "Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. (Mission swarm_mode is false)",
          "Multi-drone rules: If ANY separation_eval status == VIOLATION (...), decision MUST be REJECT. (No separation_eval status provided, implying no violation)",
          "No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC2_SingleOperatorMultiDrones",
      "description": "违规场景：单操作员同时控制两架无人机",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone2"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone2",
            "x": 500.0,
            "y": 100.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 2
          },
          "status": "VIOLATION"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone2",
            "distance": 100.0,
            "min_required": 50.0,
            "status": "OK"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 2} => status=VIOLATION\n  - Separation Drone1-Drone2: distance=100.0m min_required=50.0m => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone2\"], \"swarm_mode\": false, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone2\", \"x\": 500.0, \"y\": 100.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 2}, \"status\": \"VIOLATION\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone2\", \"distance\": 100.0, \"min_required\": 50.0, \"status\": \"OK\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The operator OP001 is assigned to 2 drones (Drone1, Drone2), which exceeds the maximum allowed limit of 1 drone per operator, resulting in an operator limit violation.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks - Operator limit: max_per_operator=1 counts={'OP001': 2} => status=VIOLATION\",\n    \"Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The operator OP001 is assigned to 2 drones (Drone1, Drone2), which exceeds the maximum allowed limit of 1 drone per operator, resulting in an operator limit violation."
        ],
        "citations": [
          "Multi-drone coordination checks - Operator limit: max_per_operator=1 counts={'OP001': 2} => status=VIOLATION",
          "Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC3_MultiOperatorsSeparate",
      "description": "合规场景：多操作员分别控制，距离足够",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone3"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone3",
            "x": 500.0,
            "y": 200.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 1,
            "OP002": 1
          },
          "status": "OK"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone3",
            "distance": 200.0,
            "min_required": 50.0,
            "status": "OK"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK\n  - Separation Drone1-Drone3: distance=200.0m min_required=50.0m => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone3\"], \"swarm_mode\": false, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone3\", \"x\": 500.0, \"y\": 200.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 1, \"OP002\": 1}, \"status\": \"OK\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone3\", \"distance\": 200.0, \"min_required\": 50.0, \"status\": \"OK\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"Operator limits are respected as per the pre-computed status.\",\n    \"Swarm mode is not active, therefore no swarm approval is required and no violation occurs.\",\n    \"All active drones maintain required separation distances.\",\n    \"There are no geofence violations.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks (pre-computed): - Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK\",\n    \"Mission: {\\\"operator_eval\\\": {\\\"max_per_operator\\\": 1, \\\"counts\\\": {\\\"OP001\\\": 1, \\\"OP002\\\": 1}, \\\"status\\\": \\\"OK\\\"}}\",\n    \"Mission: {\\\"swarm_mode\\\": false, \\\"has_approval\\\": false}\",\n    \"Multi-drone coordination checks (pre-computed): - Separation Drone1-Drone3: distance=200.0m min_required=50.0m => status=OK\",\n    \"Mission: {\\\"separation_eval\\\": [{\\\"pair\\\": \\\"Drone1-Drone3\\\", \\\"distance\\\": 200.0, \\\"min_required\\\": 50.0, \\\"status\\\": \\\"OK\\\"}]}\",\n    \"No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "Operator limits are respected as per the pre-computed status.",
          "Swarm mode is not active, therefore no swarm approval is required and no violation occurs.",
          "All active drones maintain required separation distances.",
          "There are no geofence violations."
        ],
        "citations": [
          "Multi-drone coordination checks (pre-computed): - Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK",
          "Mission: {\"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 1, \"OP002\": 1}, \"status\": \"OK\"}}",
          "Mission: {\"swarm_mode\": false, \"has_approval\": false}",
          "Multi-drone coordination checks (pre-computed): - Separation Drone1-Drone3: distance=200.0m min_required=50.0m => status=OK",
          "Mission: {\"separation_eval\": [{\"pair\": \"Drone1-Drone3\", \"distance\": 200.0, \"min_required\": 50.0, \"status\": \"OK\"}]}",
          "No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC4_SeparationViolation",
      "description": "违规场景：无人机间隔距离不足",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone3"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone3",
            "x": 500.0,
            "y": 30.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 1,
            "OP002": 1
          },
          "status": "OK"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone3",
            "distance": 30.0,
            "min_required": 50.0,
            "status": "VIOLATION"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK\n  - Separation Drone1-Drone3: distance=30.0m min_required=50.0m => status=VIOLATION\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone3\"], \"swarm_mode\": false, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone3\", \"x\": 500.0, \"y\": 30.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 1, \"OP002\": 1}, \"status\": \"OK\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone3\", \"distance\": 30.0, \"min_required\": 50.0, \"status\": \"VIOLATION\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission violates the minimum separation distance requirement between Drone1 and Drone3.\",\n    \"The separation distance for Drone1-Drone3 is 30.0m, which is less than the minimum required distance of 50.0m.\"\n  ],\n  \"citations\": [\n    \"Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT.\",\n    \"Retrieved constraints: Separation Drone1-Drone3: distance=30.0m min_required=50.0m => status=VIOLATION\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission violates the minimum separation distance requirement between Drone1 and Drone3.",
          "The separation distance for Drone1-Drone3 is 30.0m, which is less than the minimum required distance of 50.0m."
        ],
        "citations": [
          "Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT.",
          "Retrieved constraints: Separation Drone1-Drone3: distance=30.0m min_required=50.0m => status=VIOLATION"
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC5_SwarmWithoutApproval",
      "description": "违规场景：3机集群飞行未获审批",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone2",
          "Drone3"
        ],
        "swarm_mode": true,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone2",
            "x": 510.0,
            "y": 10.0,
            "z": 50.0
          },
          {
            "drone": "Drone3",
            "x": 520.0,
            "y": 20.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 2,
            "OP002": 1
          },
          "status": "VIOLATION"
        },
        "swarm_eval": {
          "swarm_threshold": 3,
          "active_drones": 3,
          "has_approval": false,
          "status": "VIOLATION"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone2",
            "distance": 14.14,
            "min_required": 50.0,
            "status": "VIOLATION"
          },
          {
            "pair": "Drone1-Drone3",
            "distance": 28.28,
            "min_required": 50.0,
            "status": "VIOLATION"
          },
          {
            "pair": "Drone2-Drone3",
            "distance": 14.14,
            "min_required": 50.0,
            "status": "VIOLATION"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 2, 'OP002': 1} => status=VIOLATION\n  - Swarm: active=3 threshold=3 has_approval=False => status=VIOLATION\n  - Separation Drone1-Drone2: distance=14.14m min_required=50.0m => status=VIOLATION\n  - Separation Drone1-Drone3: distance=28.28m min_required=50.0m => status=VIOLATION\n  - Separation Drone2-Drone3: distance=14.14m min_required=50.0m => status=VIOLATION\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone2\", \"Drone3\"], \"swarm_mode\": true, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone2\", \"x\": 510.0, \"y\": 10.0, \"z\": 50.0}, {\"drone\": \"Drone3\", \"x\": 520.0, \"y\": 20.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 2, \"OP002\": 1}, \"status\": \"VIOLATION\"}, \"swarm_eval\": {\"swarm_threshold\": 3, \"active_drones\": 3, \"has_approval\": false, \"status\": \"VIOLATION\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone2\", \"distance\": 14.14, \"min_required\": 50.0, \"status\": \"VIOLATION\"}, {\"pair\": \"Drone1-Drone3\", \"distance\": 28.28, \"min_required\": 50.0, \"status\": \"VIOLATION\"}, {\"pair\": \"Drone2-Drone3\", \"distance\": 14.14, \"min_required\": 50.0, \"status\": \"VIOLATION\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"Operator 'OP001' is assigned 2 drones, exceeding the maximum allowed limit of 1 drone per operator.\",\n    \"The mission involves a swarm of 3 drones without the required approval for swarm operations.\",\n    \"The separation distance between Drone1 and Drone2 (14.14m) is less than the minimum required distance of 50.0m.\",\n    \"The separation distance between Drone1 and Drone3 (28.28m) is less than the minimum required distance of 50.0m.\",\n    \"The separation distance between Drone2 and Drone3 (14.14m) is less than the minimum required distance of 50.0m.\"\n  ],\n  \"citations\": [\n    \"Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT.\",\n    \"Operator limit: max_per_operator=1 counts={'OP001': 2, 'OP002': 1} => status=VIOLATION\",\n    \"Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT.\",\n    \"Swarm: active=3 threshold=3 has_approval=False => status=VIOLATION\",\n    \"Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT.\",\n    \"Separation Drone1-Drone2: distance=14.14m min_required=50.0m => status=VIOLATION\",\n    \"Separation Drone1-Drone3: distance=28.28m min_required=50.0m => status=VIOLATION\",\n    \"Separation Drone2-Drone3: distance=14.14m min_required=50.0m => status=VIOLATION\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "Operator 'OP001' is assigned 2 drones, exceeding the maximum allowed limit of 1 drone per operator.",
          "The mission involves a swarm of 3 drones without the required approval for swarm operations.",
          "The separation distance between Drone1 and Drone2 (14.14m) is less than the minimum required distance of 50.0m.",
          "The separation distance between Drone1 and Drone3 (28.28m) is less than the minimum required distance of 50.0m.",
          "The separation distance between Drone2 and Drone3 (14.14m) is less than the minimum required distance of 50.0m."
        ],
        "citations": [
          "Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT.",
          "Operator limit: max_per_operator=1 counts={'OP001': 2, 'OP002': 1} => status=VIOLATION",
          "Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT.",
          "Swarm: active=3 threshold=3 has_approval=False => status=VIOLATION",
          "Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT.",
          "Separation Drone1-Drone2: distance=14.14m min_required=50.0m => status=VIOLATION",
          "Separation Drone1-Drone3: distance=28.28m min_required=50.0m => status=VIOLATION",
          "Separation Drone2-Drone3: distance=14.14m min_required=50.0m => status=VIOLATION"
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC6_SwarmWithApproval",
      "description": "合规场景：已审批的集群飞行",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone2",
          "Drone3"
        ],
        "swarm_mode": true,
        "has_approval": true,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone2",
            "x": 500.0,
            "y": 60.0,
            "z": 50.0
          },
          {
            "drone": "Drone3",
            "x": 500.0,
            "y": 120.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 2,
            "OP002": 1
          },
          "status": "OK"
        },
        "swarm_eval": {
          "swarm_threshold": 3,
          "active_drones": 3,
          "has_approval": true,
          "status": "OK"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone2",
            "distance": 60.0,
            "min_required": 50.0,
            "status": "OK"
          },
          {
            "pair": "Drone1-Drone3",
            "distance": 120.0,
            "min_required": 50.0,
            "status": "OK"
          },
          {
            "pair": "Drone2-Drone3",
            "distance": 60.0,
            "min_required": 50.0,
            "status": "OK"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 2, 'OP002': 1} => status=OK\n  - Swarm: active=3 threshold=3 has_approval=True => status=OK\n  - Separation Drone1-Drone2: distance=60.0m min_required=50.0m => status=OK\n  - Separation Drone1-Drone3: distance=120.0m min_required=50.0m => status=OK\n  - Separation Drone2-Drone3: distance=60.0m min_required=50.0m => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone2\", \"Drone3\"], \"swarm_mode\": true, \"has_approval\": true, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone2\", \"x\": 500.0, \"y\": 60.0, \"z\": 50.0}, {\"drone\": \"Drone3\", \"x\": 500.0, \"y\": 120.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 2, \"OP002\": 1}, \"status\": \"OK\"}, \"swarm_eval\": {\"swarm_threshold\": 3, \"active_drones\": 3, \"has_approval\": true, \"status\": \"OK\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone2\", \"distance\": 60.0, \"min_required\": 50.0, \"status\": \"OK\"}, {\"pair\": \"Drone1-Drone3\", \"distance\": 120.0, \"min_required\": 50.0, \"status\": \"OK\"}, {\"pair\": \"Drone2-Drone3\", \"distance\": 60.0, \"min_required\": 50.0, \"status\": \"OK\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All multi-drone coordination checks (operator limit, swarm, and drone separation) are satisfied.\",\n    \"The operator limit for drones per operator is not violated.\",\n    \"The swarm operation has the required approval.\",\n    \"All drones maintain the minimum required separation distance.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks (pre-computed): Operator limit: status=OK\",\n    \"Multi-drone coordination checks (pre-computed): Swarm: status=OK\",\n    \"Multi-drone coordination checks (pre-computed): Separation Drone1-Drone2: distance=60.0m min_required=50.0m => status=OK\",\n    \"Multi-drone coordination checks (pre-computed): Separation Drone1-Drone3: distance=120.0m min_required=50.0m => status=OK\",\n    \"Multi-drone coordination checks (pre-computed): Separation Drone2-Drone3: distance=60.0m min_required=50.0m => status=OK\",\n    \"No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All multi-drone coordination checks (operator limit, swarm, and drone separation) are satisfied.",
          "The operator limit for drones per operator is not violated.",
          "The swarm operation has the required approval.",
          "All drones maintain the minimum required separation distance."
        ],
        "citations": [
          "Multi-drone coordination checks (pre-computed): Operator limit: status=OK",
          "Multi-drone coordination checks (pre-computed): Swarm: status=OK",
          "Multi-drone coordination checks (pre-computed): Separation Drone1-Drone2: distance=60.0m min_required=50.0m => status=OK",
          "Multi-drone coordination checks (pre-computed): Separation Drone1-Drone3: distance=120.0m min_required=50.0m => status=OK",
          "Multi-drone coordination checks (pre-computed): Separation Drone2-Drone3: distance=60.0m min_required=50.0m => status=OK",
          "No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject."
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC7_SequentialOperation",
      "description": "合规场景：单操作员顺序操作（非同时飞行）",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone2"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "sequential_mode": true,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 300.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone2",
            "x": 300.0,
            "y": 100.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 300.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "separation_eval": [
          {
            "pair": "Drone1-Drone2",
            "distance": 100.0,
            "min_required": 50.0,
            "status": "OK"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Separation Drone1-Drone2: distance=100.0m min_required=50.0m => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone2\"], \"swarm_mode\": false, \"has_approval\": false, \"sequential_mode\": true, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 300.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone2\", \"x\": 300.0, \"y\": 100.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 300.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"separation_eval\": [{\"pair\": \"Drone1-Drone2\", \"distance\": 100.0, \"min_required\": 50.0, \"status\": \"OK\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"No separation violations were detected for any drone pair.\",\n    \"The mission is not operating in swarm mode, therefore swarm approval is not required.\",\n    \"No geofence violations are present, and geofence constraints are explicitly excluded as a reason for rejection.\",\n    \"No operator evaluation status indicating a violation was provided, therefore this constraint does not trigger a rejection.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks (pre-computed): - Separation Drone1-Drone2: distance=100.0m min_required=50.0m => status=OK\",\n    \"Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. (Current status for all separations is OK)\",\n    \"Mission: {\\\"swarm_mode\\\": false, \\\"has_approval\\\": false}\",\n    \"Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. (Not a swarm, so not a violation)\",\n    \"No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\",\n    \"Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. (No operator_eval status was provided as 'VIOLATION')\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "No separation violations were detected for any drone pair.",
          "The mission is not operating in swarm mode, therefore swarm approval is not required.",
          "No geofence violations are present, and geofence constraints are explicitly excluded as a reason for rejection.",
          "No operator evaluation status indicating a violation was provided, therefore this constraint does not trigger a rejection."
        ],
        "citations": [
          "Multi-drone coordination checks (pre-computed): - Separation Drone1-Drone2: distance=100.0m min_required=50.0m => status=OK",
          "Multi-drone rules: If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. (Current status for all separations is OK)",
          "Mission: {\"swarm_mode\": false, \"has_approval\": false}",
          "Multi-drone rules: If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. (Not a swarm, so not a violation)",
          "No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.",
          "Multi-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. (No operator_eval status was provided as 'VIOLATION')"
        ]
      },
      "retrieved_constraints": []
    },
    {
      "test_case_id": "TC8_BoundarySeparation",
      "description": "边界测试：恰好50米分离距离",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "active_drones": [
          "Drone1",
          "Drone3"
        ],
        "swarm_mode": false,
        "has_approval": false,
        "drone_targets": [
          {
            "drone": "Drone1",
            "x": 500.0,
            "y": 0.0,
            "z": 50.0
          },
          {
            "drone": "Drone3",
            "x": 500.0,
            "y": 50.0,
            "z": 50.0
          }
        ],
        "target_xyz": {
          "x": 500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "operator_eval": {
          "max_per_operator": 1,
          "counts": {
            "OP001": 1,
            "OP002": 1
          },
          "status": "OK"
        },
        "separation_eval": [
          {
            "pair": "Drone1-Drone3",
            "distance": 50.0,
            "min_required": 50.0,
            "status": "OK"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\nMulti-drone coordination checks (pre-computed):\n  - Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK\n  - Separation Drone1-Drone3: distance=50.0m min_required=50.0m => status=OK\nMulti-drone rules: If operator_eval status == VIOLATION (operator controlling more than allowed drones and no exemption), decision MUST be REJECT. If swarm_eval status == VIOLATION (swarm without required approval), decision MUST be REJECT. If ANY separation_eval status == VIOLATION (distance < min_required), decision MUST be REJECT. Boundary inclusive: distance >= min_required is OK.\nNo geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\nMission: {\"active_drones\": [\"Drone1\", \"Drone3\"], \"swarm_mode\": false, \"has_approval\": false, \"drone_targets\": [{\"drone\": \"Drone1\", \"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, {\"drone\": \"Drone3\", \"x\": 500.0, \"y\": 50.0, \"z\": 50.0}], \"target_xyz\": {\"x\": 500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"operator_eval\": {\"max_per_operator\": 1, \"counts\": {\"OP001\": 1, \"OP002\": 1}, \"status\": \"OK\"}, \"separation_eval\": [{\"pair\": \"Drone1-Drone3\", \"distance\": 50.0, \"min_required\": 50.0, \"status\": \"OK\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"Operator limit check passed: All operators are within their maximum drone limit.\",\n    \"Separation check passed: All drone pairs maintain the minimum required separation distance.\",\n    \"Swarm mode check passed: Swarm mode is not active, so no swarm approval is required.\",\n    \"No geofence constraints were provided, so no geofence violation exists.\"\n  ],\n  \"citations\": [\n    \"Multi-drone coordination checks (pre-computed): Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK\",\n    \"Multi-drone coordination checks (pre-computed): Separation Drone1-Drone3: distance=50.0m min_required=50.0m => status=OK\",\n    \"Mission: {\\\"swarm_mode\\\": false, \\\"has_approval\\\": false}\",\n    \"No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "Operator limit check passed: All operators are within their maximum drone limit.",
          "Separation check passed: All drone pairs maintain the minimum required separation distance.",
          "Swarm mode check passed: Swarm mode is not active, so no swarm approval is required.",
          "No geofence constraints were provided, so no geofence violation exists."
        ],
        "citations": [
          "Multi-drone coordination checks (pre-computed): Operator limit: max_per_operator=1 counts={'OP001': 1, 'OP002': 1} => status=OK",
          "Multi-drone coordination checks (pre-computed): Separation Drone1-Drone3: distance=50.0m min_required=50.0m => status=OK",
          "Mission: {\"swarm_mode\": false, \"has_approval\": false}",
          "No geofence constraints provided; there is NO geofence violation and geofence must NOT be used to reject."
        ]
      },
      "retrieved_constraints": []
    }
  ]
}