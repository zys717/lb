{
  "scenario": "S014",
  "summary": {
    "total_test_cases": 6,
    "llm_calls": 6,
    "llm_accuracy": "6/6",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1",
      "description": "基础VLOS内飞行（400m），无需豁免",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 400.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 400.0,
            "y": 0.0
          },
          "horizontal_distance": 400.0,
          "limit": 500.0,
          "status": "OK"
        },
        "bvlos_eval": {
          "distance": 400.0,
          "base_limit": 500.0,
          "effective_limit": 500.0,
          "applied_waivers": [],
          "status": "OK"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nVLOS check (pre-computed): horiz_distance=400.0m, limit=500.0m => status=OK\nBVLOS check (pre-computed): distance=400.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=OK\nVLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT. Boundary inclusive: distance <= limit is OK.\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- VLOS check: horiz_distance=400.0 m vs limit=500.0 m -> OK.\n- BVLOS check: distance=400.0 m vs effective_limit=500.0 m (base 500.0 m, waivers=[]) -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 400.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 400.0, \"y\": 0.0}, \"horizontal_distance\": 400.0, \"limit\": 500.0, \"status\": \"OK\"}, \"bvlos_eval\": {\"distance\": 400.0, \"base_limit\": 500.0, \"effective_limit\": 500.0, \"applied_waivers\": [], \"status\": \"OK\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All pre-computed auto-checks, including VLOS and BVLOS, returned an 'OK' status.\",\n    \"The VLOS rule is satisfied as the horizontal distance (400.0m) is within the limit (500.0m).\",\n    \"The BVLOS rule is satisfied as the distance (400.0m) is within the effective limit (500.0m).\",\n    \"No geofence constraints were provided, defaulting to 'outside' and thus not violating any geofence rules.\",\n    \"The mission altitude of 50.0m is consistent with the retrieved altitude constraints from SOP S014_bvlos_waiver.jsonc, which lists 50.0m multiple times.\"\n  ],\n  \"citations\": [\n    \"VLOS check (pre-computed): horiz_distance=400.0m, limit=500.0m => status=OK\",\n    \"BVLOS check (pre-computed): distance=400.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=OK\",\n    \"VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT. Boundary inclusive: distance <= limit is OK.\",\n    \"BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\",\n    \"Auto checks: VLOS check: horiz_distance=400.0 m vs limit=500.0 m -> OK.\",\n    \"Auto checks: BVLOS check: distance=400.0 m vs effective_limit=500.0 m (base 500.0 m, waivers=[]) -> OK.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default.\",\n    \"Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All pre-computed auto-checks, including VLOS and BVLOS, returned an 'OK' status.",
          "The VLOS rule is satisfied as the horizontal distance (400.0m) is within the limit (500.0m).",
          "The BVLOS rule is satisfied as the distance (400.0m) is within the effective limit (500.0m).",
          "No geofence constraints were provided, defaulting to 'outside' and thus not violating any geofence rules.",
          "The mission altitude of 50.0m is consistent with the retrieved altitude constraints from SOP S014_bvlos_waiver.jsonc, which lists 50.0m multiple times."
        ],
        "citations": [
          "VLOS check (pre-computed): horiz_distance=400.0m, limit=500.0m => status=OK",
          "BVLOS check (pre-computed): distance=400.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=OK",
          "VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT. Boundary inclusive: distance <= limit is OK.",
          "BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.",
          "Auto checks: VLOS check: horiz_distance=400.0 m vs limit=500.0 m -> OK.",
          "Auto checks: BVLOS check: distance=400.0 m vs effective_limit=500.0 m (base 500.0 m, waivers=[]) -> OK.",
          "No geofence constraints provided; treat geofence checks as outside by default.",
          "Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)"
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC2",
      "description": "超视距飞行（600m），无豁免应拒绝",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 600.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 600.0,
            "y": 0.0
          },
          "horizontal_distance": 600.0,
          "limit": 500.0,
          "status": "VIOLATION"
        },
        "bvlos_eval": {
          "distance": 600.0,
          "base_limit": 500.0,
          "effective_limit": 500.0,
          "applied_waivers": [],
          "status": "VIOLATION"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nVLOS check (pre-computed): horiz_distance=600.0m, limit=500.0m => status=VIOLATION\nBVLOS check (pre-computed): distance=600.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=VIOLATION\nVLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT. Boundary inclusive: distance <= limit is OK.\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- VLOS check: horiz_distance=600.0 m vs limit=500.0 m -> VIOLATION.\n- BVLOS check: distance=600.0 m vs effective_limit=500.0 m (base 500.0 m, waivers=[]) -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 600.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 600.0, \"y\": 0.0}, \"horizontal_distance\": 600.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}, \"bvlos_eval\": {\"distance\": 600.0, \"base_limit\": 500.0, \"effective_limit\": 500.0, \"applied_waivers\": [], \"status\": \"VIOLATION\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission violates the Visual Line of Sight (VLOS) horizontal distance limit. The horizontal distance of 600.0m exceeds the allowed limit of 500.0m.\",\n    \"The mission violates the Beyond Visual Line of Sight (BVLOS) effective distance limit. The mission distance of 600.0m exceeds the effective limit of 500.0m, with no waivers applied to extend this limit.\",\n    \"Per hard rules, any auto-check resulting in a VIOLATION status mandates a REJECT decision. Both VLOS and BVLOS auto-checks resulted in VIOLATION.\"\n  ],\n  \"citations\": [\n    \"VLOS check (pre-computed): horiz_distance=600.0m, limit=500.0m => status=VIOLATION\",\n    \"VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT.\",\n    \"BVLOS check (pre-computed): distance=600.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=VIOLATION\",\n    \"BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission violates the Visual Line of Sight (VLOS) horizontal distance limit. The horizontal distance of 600.0m exceeds the allowed limit of 500.0m.",
          "The mission violates the Beyond Visual Line of Sight (BVLOS) effective distance limit. The mission distance of 600.0m exceeds the effective limit of 500.0m, with no waivers applied to extend this limit.",
          "Per hard rules, any auto-check resulting in a VIOLATION status mandates a REJECT decision. Both VLOS and BVLOS auto-checks resulted in VIOLATION."
        ],
        "citations": [
          "VLOS check (pre-computed): horiz_distance=600.0m, limit=500.0m => status=VIOLATION",
          "VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT.",
          "BVLOS check (pre-computed): distance=600.0m, effective_limit=500.0m, base_limit=500.0m, waivers=[] => status=VIOLATION",
          "BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC3",
      "description": "超视距飞行（600m），启用观察员豁免应批准",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 600.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [
          "W001_VisualObserver"
        ],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 600.0,
            "y": 0.0
          },
          "horizontal_distance": 600.0,
          "limit": 500.0,
          "status": "VIOLATION"
        },
        "bvlos_eval": {
          "distance": 600.0,
          "base_limit": 500.0,
          "effective_limit": 1100.0,
          "applied_waivers": [
            "W001_VisualObserver"
          ],
          "status": "OK"
        },
        "vlos_ignored_due_to_bvlos": true
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nBVLOS check (pre-computed): distance=600.0m, effective_limit=1100.0m, base_limit=500.0m, waivers=['W001_VisualObserver'] => status=OK\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- BVLOS check: distance=600.0 m vs effective_limit=1100.0 m (base 500.0 m, waivers=['W001_VisualObserver']) -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 600.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [\"W001_VisualObserver\"], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 600.0, \"y\": 0.0}, \"horizontal_distance\": 600.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}, \"bvlos_eval\": {\"distance\": 600.0, \"base_limit\": 500.0, \"effective_limit\": 1100.0, \"applied_waivers\": [\"W001_VisualObserver\"], \"status\": \"OK\"}, \"vlos_ignored_due_to_bvlos\": true}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All auto_checks are OK: The BVLOS check passed, with a distance of 600.0 m being within the effective limit of 1100.0 m, enabled by the W001_VisualObserver waiver.\",\n    \"The VLOS violation is ignored: As the bvlos_eval status is OK with waivers applied, the VLOS violation (600.0m horizontal distance vs 500.0m limit) is permitted to be ignored for this mission.\",\n    \"Mission altitude of 50.0m complies with retrieved altitude constraints.\",\n    \"No geofence violations: Geofence checks are treated as outside by default, as no specific constraints were provided.\"\n  ],\n  \"citations\": [\n    \"Auto checks: - BVLOS check: distance=600.0 m vs effective_limit=1100.0 m (base 500.0 m, waivers=['W001_VisualObserver']) -> OK.\",\n    \"BVLOS rule: If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission.\",\n    \"Mission: {\\\"vlos_ignored_due_to_bvlos\\\": true}\",\n    \"Mission: {\\\"altitude_m\\\": 50.0}\",\n    \"Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\",\n    \"Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All auto_checks are OK: The BVLOS check passed, with a distance of 600.0 m being within the effective limit of 1100.0 m, enabled by the W001_VisualObserver waiver.",
          "The VLOS violation is ignored: As the bvlos_eval status is OK with waivers applied, the VLOS violation (600.0m horizontal distance vs 500.0m limit) is permitted to be ignored for this mission.",
          "Mission altitude of 50.0m complies with retrieved altitude constraints.",
          "No geofence violations: Geofence checks are treated as outside by default, as no specific constraints were provided."
        ],
        "citations": [
          "Auto checks: - BVLOS check: distance=600.0 m vs effective_limit=1100.0 m (base 500.0 m, waivers=['W001_VisualObserver']) -> OK.",
          "BVLOS rule: If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission.",
          "Mission: {\"vlos_ignored_due_to_bvlos\": true}",
          "Mission: {\"altitude_m\": 50.0}",
          "Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)",
          "Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.",
          "No geofence constraints provided; treat geofence checks as outside by default."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC4",
      "description": "远距离飞行（1500m），启用技术手段豁免应批准",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 1500.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [
          "W002_TechnicalMeans"
        ],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 1500.0,
            "y": 0.0
          },
          "horizontal_distance": 1500.0,
          "limit": 500.0,
          "status": "VIOLATION"
        },
        "bvlos_eval": {
          "distance": 1500.0,
          "base_limit": 500.0,
          "effective_limit": 2000.0,
          "applied_waivers": [
            "W002_TechnicalMeans"
          ],
          "status": "OK"
        },
        "vlos_ignored_due_to_bvlos": true
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nBVLOS check (pre-computed): distance=1500.0m, effective_limit=2000.0m, base_limit=500.0m, waivers=['W002_TechnicalMeans'] => status=OK\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- BVLOS check: distance=1500.0 m vs effective_limit=2000.0 m (base 500.0 m, waivers=['W002_TechnicalMeans']) -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 1500.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [\"W002_TechnicalMeans\"], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 1500.0, \"y\": 0.0}, \"horizontal_distance\": 1500.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}, \"bvlos_eval\": {\"distance\": 1500.0, \"base_limit\": 500.0, \"effective_limit\": 2000.0, \"applied_waivers\": [\"W002_TechnicalMeans\"], \"status\": \"OK\"}, \"vlos_ignored_due_to_bvlos\": true}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"The mission altitude of 50.0m aligns with the specified altitude constraints from SOP S014_bvlos_waiver.jsonc.\",\n    \"The BVLOS check status is OK, as the mission distance (1500.0m) is within the effective limit (2000.0m) due to the 'W002_TechnicalMeans' waiver.\",\n    \"Although a VLOS violation was detected (horizontal_distance 1500.0m exceeds limit 500.0m), it is ignored for this mission because the BVLOS evaluation status is OK with waivers applied, as per the BVLOS rule.\",\n    \"All provided auto_check statuses are OK.\",\n    \"Geofence checks are considered outside by default, as no geofence constraints were provided.\",\n    \"The hard rules for approval are met, as all auto_check statuses are OK and geofence checks are outside.\"\n  ],\n  \"citations\": [\n    \"Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\",\n    \"BVLOS check: distance=1500.0 m vs effective_limit=2000.0 m (base 500.0 m, waivers=['W002_TechnicalMeans']) -> OK.\",\n    \"BVLOS rule: If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission.\",\n    \"Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "The mission altitude of 50.0m aligns with the specified altitude constraints from SOP S014_bvlos_waiver.jsonc.",
          "The BVLOS check status is OK, as the mission distance (1500.0m) is within the effective limit (2000.0m) due to the 'W002_TechnicalMeans' waiver.",
          "Although a VLOS violation was detected (horizontal_distance 1500.0m exceeds limit 500.0m), it is ignored for this mission because the BVLOS evaluation status is OK with waivers applied, as per the BVLOS rule.",
          "All provided auto_check statuses are OK.",
          "Geofence checks are considered outside by default, as no geofence constraints were provided.",
          "The hard rules for approval are met, as all auto_check statuses are OK and geofence checks are outside."
        ],
        "citations": [
          "Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)",
          "BVLOS check: distance=1500.0 m vs effective_limit=2000.0 m (base 500.0 m, waivers=['W002_TechnicalMeans']) -> OK.",
          "BVLOS rule: If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission.",
          "Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.",
          "No geofence constraints provided; treat geofence checks as outside by default."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC5",
      "description": "超远距离飞行（3000m），启用特殊许可应批准",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 3000.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [
          "W003_SpecialPermit"
        ],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 3000.0,
            "y": 0.0
          },
          "horizontal_distance": 3000.0,
          "limit": 500.0,
          "status": "VIOLATION"
        },
        "bvlos_eval": {
          "distance": 3000.0,
          "base_limit": 500.0,
          "effective_limit": 5000.0,
          "applied_waivers": [
            "W003_SpecialPermit"
          ],
          "status": "OK"
        },
        "vlos_ignored_due_to_bvlos": true
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nBVLOS check (pre-computed): distance=3000.0m, effective_limit=5000.0m, base_limit=500.0m, waivers=['W003_SpecialPermit'] => status=OK\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- BVLOS check: distance=3000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 3000.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [\"W003_SpecialPermit\"], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 3000.0, \"y\": 0.0}, \"horizontal_distance\": 3000.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}, \"bvlos_eval\": {\"distance\": 3000.0, \"base_limit\": 500.0, \"effective_limit\": 5000.0, \"applied_waivers\": [\"W003_SpecialPermit\"], \"status\": \"OK\"}, \"vlos_ignored_due_to_bvlos\": true}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All automatic checks passed. The BVLOS check was OK, with an effective limit of 5000.0m exceeding the mission distance of 3000.0m, utilizing waiver 'W003_SpecialPermit'.\",\n    \"The mission altitude of 50.0m is permissible as per the retrieved altitude constraints associated with SOP S014_bvlos_waiver.jsonc.\",\n    \"Although a VLOS violation was detected (horizontal distance 3000.0m vs limit 500.0m), the BVLOS rule explicitly allows ignoring VLOS violations when the BVLOS evaluation status is OK with waivers applied, which is the case here.\",\n    \"Geofence checks are treated as 'outside' by default, as no specific geofence constraints were provided.\"\n  ],\n  \"citations\": [\n    \"Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc) - Mission altitude 50.0m matches this constraint.\",\n    \"BVLOS check: distance=3000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> OK. - Automatic BVLOS check passed.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE. - All auto checks were OK, fulfilling part of this rule.\",\n    \"BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. - BVLOS evaluation was OK, allowing VLOS violation to be ignored.\",\n    \"Mission: {\\\"vlos_eval\\\": {\\\"operator\\\": {\\\"x\\\": 0.0, \\\"y\\\": 0.0}, \\\"target\\\": {\\\"x\\\": 3000.0, \\\"y\\\": 0.0}, \\\"horizontal_distance\\\": 3000.0, \\\"limit\\\": 500.0, \\\"status\\\": \\\"VIOLATION\\\"}} - VLOS was violated but ignored per BVLOS rule.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default. - Geofence condition for approval met by default.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All automatic checks passed. The BVLOS check was OK, with an effective limit of 5000.0m exceeding the mission distance of 3000.0m, utilizing waiver 'W003_SpecialPermit'.",
          "The mission altitude of 50.0m is permissible as per the retrieved altitude constraints associated with SOP S014_bvlos_waiver.jsonc.",
          "Although a VLOS violation was detected (horizontal distance 3000.0m vs limit 500.0m), the BVLOS rule explicitly allows ignoring VLOS violations when the BVLOS evaluation status is OK with waivers applied, which is the case here.",
          "Geofence checks are treated as 'outside' by default, as no specific geofence constraints were provided."
        ],
        "citations": [
          "Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc) - Mission altitude 50.0m matches this constraint.",
          "BVLOS check: distance=3000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> OK. - Automatic BVLOS check passed.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE. - All auto checks were OK, fulfilling part of this rule.",
          "BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. - BVLOS evaluation was OK, allowing VLOS violation to be ignored.",
          "Mission: {\"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 3000.0, \"y\": 0.0}, \"horizontal_distance\": 3000.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}} - VLOS was violated but ignored per BVLOS rule.",
          "No geofence constraints provided; treat geofence checks as outside by default. - Geofence condition for approval met by default."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC6",
      "description": "超远距离飞行（6000m），即使有特殊许可也超出范围应拒绝",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 6000.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "waivers_enabled": [
          "W003_SpecialPermit"
        ],
        "vlos_eval": {
          "operator": {
            "x": 0.0,
            "y": 0.0
          },
          "target": {
            "x": 6000.0,
            "y": 0.0
          },
          "horizontal_distance": 6000.0,
          "limit": 500.0,
          "status": "VIOLATION"
        },
        "bvlos_eval": {
          "distance": 6000.0,
          "base_limit": 500.0,
          "effective_limit": 5000.0,
          "applied_waivers": [
            "W003_SpecialPermit"
          ],
          "status": "VIOLATION"
        }
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 0.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\n- Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc)\nVLOS check (pre-computed): horiz_distance=6000.0m, limit=500.0m => status=VIOLATION\nBVLOS check (pre-computed): distance=6000.0m, effective_limit=5000.0m, base_limit=500.0m, waivers=['W003_SpecialPermit'] => status=VIOLATION\nVLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT. Boundary inclusive: distance <= limit is OK.\nBVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT. If bvlos_eval is OK with waivers applied, you may ignore VLOS violations for this mission. effective_limit may be extended by waivers; boundary inclusive.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- VLOS check: horiz_distance=6000.0 m vs limit=500.0 m -> VIOLATION.\n- BVLOS check: distance=6000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 6000.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"waivers_enabled\": [\"W003_SpecialPermit\"], \"vlos_eval\": {\"operator\": {\"x\": 0.0, \"y\": 0.0}, \"target\": {\"x\": 6000.0, \"y\": 0.0}, \"horizontal_distance\": 6000.0, \"limit\": 500.0, \"status\": \"VIOLATION\"}, \"bvlos_eval\": {\"distance\": 6000.0, \"base_limit\": 500.0, \"effective_limit\": 5000.0, \"applied_waivers\": [\"W003_SpecialPermit\"], \"status\": \"VIOLATION\"}}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The VLOS check resulted in a VIOLATION because the horizontal distance (6000.0m) significantly exceeded the permissible limit (500.0m). According to the VLOS hard constraint, this mandates a REJECT decision.\",\n    \"The BVLOS check also resulted in a VIOLATION because the mission distance (6000.0m) exceeded the effective limit (5000.0m), even with the 'W003_SpecialPermit' waiver applied. The BVLOS rule dictates a REJECT for such violations.\",\n    \"Per the hard rules, if any auto-check status is VIOLATION, the decision MUST be REJECT. Both VLOS and BVLOS auto-checks are in VIOLATION.\"\n  ],\n  \"citations\": [\n    \"VLOS check (pre-computed): horiz_distance=6000.0m, limit=500.0m => status=VIOLATION\",\n    \"VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT.\",\n    \"BVLOS check (pre-computed): distance=6000.0m, effective_limit=5000.0m, base_limit=500.0m, waivers=['W003_SpecialPermit'] => status=VIOLATION\",\n    \"BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\",\n    \"Auto checks: VLOS check: horiz_distance=6000.0 m vs limit=500.0 m -> VIOLATION.\",\n    \"Auto checks: BVLOS check: distance=6000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> VIOLATION.\",\n    \"Mission: {\\\"altitude_m\\\": 50.0} (Altitude is consistent with retrieved constraints: Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc))\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The VLOS check resulted in a VIOLATION because the horizontal distance (6000.0m) significantly exceeded the permissible limit (500.0m). According to the VLOS hard constraint, this mandates a REJECT decision.",
          "The BVLOS check also resulted in a VIOLATION because the mission distance (6000.0m) exceeded the effective limit (5000.0m), even with the 'W003_SpecialPermit' waiver applied. The BVLOS rule dictates a REJECT for such violations.",
          "Per the hard rules, if any auto-check status is VIOLATION, the decision MUST be REJECT. Both VLOS and BVLOS auto-checks are in VIOLATION."
        ],
        "citations": [
          "VLOS check (pre-computed): horiz_distance=6000.0m, limit=500.0m => status=VIOLATION",
          "VLOS rule (hard constraint): if vlos_eval status == VIOLATION (distance > limit), decision MUST be REJECT.",
          "BVLOS check (pre-computed): distance=6000.0m, effective_limit=5000.0m, base_limit=500.0m, waivers=['W003_SpecialPermit'] => status=VIOLATION",
          "BVLOS rule: if bvlos_eval status == VIOLATION (distance > effective_limit), decision MUST be REJECT.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.",
          "Auto checks: VLOS check: horiz_distance=6000.0 m vs limit=500.0 m -> VIOLATION.",
          "Auto checks: BVLOS check: distance=6000.0 m vs effective_limit=5000.0 m (base 500.0 m, waivers=['W003_SpecialPermit']) -> VIOLATION.",
          "Mission: {\"altitude_m\": 50.0} (Altitude is consistent with retrieved constraints: Altitude: 50.0m (SOP S014_bvlos_waiver.jsonc))"
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_vlos_configuration_operator_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_scenario_parameters_bvlos_waiver_config_visual_observer_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S014_bvlos_waiver.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S014_bvlos_waiver.jsonc",
          "constraint_id": "S014_bvlos_waiver_test_cases_test_points_target_position_altitude"
        }
      ]
    }
  ]
}