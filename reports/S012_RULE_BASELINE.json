{
  "scenario": "S012",
  "summary": {
    "total_test_cases": 5,
    "llm_calls": 5,
    "llm_accuracy": "5/5",
    "llm_accuracy_percent": "100.0%"
  },
  "results": [
    {
      "test_case_id": "TC1",
      "description": "白天（14:00），医院区域外飞行，应允许",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 0.0,
          "y": 200.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "time_of_day": "14:00",
        "night_eval": {
          "time_of_day": "14:00",
          "is_night": false,
          "light_required": false,
          "light_on": false,
          "training_required": false,
          "training_ok": false,
          "status": "OK",
          "reasons": [
            "Night check ignored because all time window statuses are outside."
          ]
        },
        "time_window_eval": [
          {
            "zone_id": "hospital_zone",
            "distance": 282.84,
            "radius": 150.0,
            "time": "14:00",
            "start": "22:00",
            "end": "06:00",
            "in_zone": false,
            "in_window": false,
            "status": "outside"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: -120.0m (SOP S012_time_window.jsonc)\n- Altitude: 0.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\nTime window checks (pre-computed):\n  - zone=hospital_zone: distance=282.84m radius=150.0m time=14:00 window=(22:00-06:00) in_zone=False in_window=False => status=outside\nTime window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Night check: time=14:00 is_night=False light_on=False training_ok=False -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 0.0, \"y\": 200.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"time_of_day\": \"14:00\", \"night_eval\": {\"time_of_day\": \"14:00\", \"is_night\": false, \"light_required\": false, \"light_on\": false, \"training_required\": false, \"training_ok\": false, \"status\": \"OK\", \"reasons\": [\"Night check ignored because all time window statuses are outside.\"]}, \"time_window_eval\": [{\"zone_id\": \"hospital_zone\", \"distance\": 282.84, \"radius\": 150.0, \"time\": \"14:00\", \"start\": \"22:00\", \"end\": \"06:00\", \"in_zone\": false, \"in_window\": false, \"status\": \"outside\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"All auto_check statuses are OK.\",\n    \"No time window evaluation status is 'inside'.\",\n    \"Geofence checks are considered 'outside' as no constraints were provided.\",\n    \"The mission altitude of 50.0m is compliant with retrieved altitude constraints.\"\n  ],\n  \"citations\": [\n    \"Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. (Mission has 'outside' status for time_window_eval)\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. (Night check status is OK)\",\n    \"Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default.\",\n    \"Altitude: 50.0m (SOP S012_time_window.jsonc) - Mission altitude 50.0m is within allowed parameters.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "All auto_check statuses are OK.",
          "No time window evaluation status is 'inside'.",
          "Geofence checks are considered 'outside' as no constraints were provided.",
          "The mission altitude of 50.0m is compliant with retrieved altitude constraints."
        ],
        "citations": [
          "Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. (Mission has 'outside' status for time_window_eval)",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. (Night check status is OK)",
          "Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.",
          "No geofence constraints provided; treat geofence checks as outside by default.",
          "Altitude: 50.0m (SOP S012_time_window.jsonc) - Mission altitude 50.0m is within allowed parameters."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "-120.0",
          "raw_unit": "m",
          "canonical_value": "-120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_min"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_max"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC2",
      "description": "白天（14:00），医院区域内飞行，应允许（白天不限制）",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 200.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "time_of_day": "14:00",
        "night_eval": {
          "time_of_day": "14:00",
          "is_night": false,
          "light_required": false,
          "light_on": false,
          "training_required": false,
          "training_ok": false,
          "status": "OK",
          "reasons": [
            "Night check ignored because all time window statuses are outside."
          ]
        },
        "time_window_eval": [
          {
            "zone_id": "hospital_zone",
            "distance": 0.0,
            "radius": 150.0,
            "time": "14:00",
            "start": "22:00",
            "end": "06:00",
            "in_zone": true,
            "in_window": false,
            "status": "outside"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: -120.0m (SOP S012_time_window.jsonc)\n- Altitude: 0.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\nTime window checks (pre-computed):\n  - zone=hospital_zone: distance=0.0m radius=150.0m time=14:00 window=(22:00-06:00) in_zone=True in_window=False => status=outside\nTime window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Night check: time=14:00 is_night=False light_on=False training_ok=False -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 200.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"time_of_day\": \"14:00\", \"night_eval\": {\"time_of_day\": \"14:00\", \"is_night\": false, \"light_required\": false, \"light_on\": false, \"training_required\": false, \"training_ok\": false, \"status\": \"OK\", \"reasons\": [\"Night check ignored because all time window statuses are outside.\"]}, \"time_window_eval\": [{\"zone_id\": \"hospital_zone\", \"distance\": 0.0, \"radius\": 150.0, \"time\": \"14:00\", \"start\": \"22:00\", \"end\": \"06:00\", \"in_zone\": true, \"in_window\": false, \"status\": \"outside\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"The mission altitude of 50.0m is compliant with the retrieved altitude constraints.\",\n    \"All pre-computed time window checks for 'hospital_zone' indicate a 'status=outside', meaning the mission is not operating within a restricted time window for any monitored zone. This prevents a REJECT based on the 'time window rule'.\",\n    \"The 'Night check' auto-check has a status of 'OK', indicating no violations for night operations.\",\n    \"No geofence constraints were provided, so geofence checks are treated as 'outside' by default.\",\n    \"All auto_check statuses are 'OK' and geofence checks are 'outside', thus satisfying the conditions for an 'APPROVE' decision.\"\n  ],\n  \"citations\": [\n    \"Altitude: 50.0m (SOP S012_time_window.jsonc)\",\n    \"Mission: {\\\"target_xyz\\\": {\\\"x\\\": 200.0, \\\"y\\\": 0.0, \\\"z\\\": 50.0}, \\\"altitude_m\\\": 50.0}\",\n    \"Time window checks (pre-computed): - zone=hospital_zone: ... status=outside\",\n    \"Mission: \\\"time_window_eval\\\": [... \\\"status\\\": \\\"outside\\\"]\",\n    \"Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\",\n    \"Auto checks: - Night check: ... -> OK.\",\n    \"Mission: \\\"night_eval\\\": {\\\"status\\\": \\\"OK\\\"}\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\",\n    \"No geofence constraints provided; treat geofence checks as outside by default.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "The mission altitude of 50.0m is compliant with the retrieved altitude constraints.",
          "All pre-computed time window checks for 'hospital_zone' indicate a 'status=outside', meaning the mission is not operating within a restricted time window for any monitored zone. This prevents a REJECT based on the 'time window rule'.",
          "The 'Night check' auto-check has a status of 'OK', indicating no violations for night operations.",
          "No geofence constraints were provided, so geofence checks are treated as 'outside' by default.",
          "All auto_check statuses are 'OK' and geofence checks are 'outside', thus satisfying the conditions for an 'APPROVE' decision."
        ],
        "citations": [
          "Altitude: 50.0m (SOP S012_time_window.jsonc)",
          "Mission: {\"target_xyz\": {\"x\": 200.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0}",
          "Time window checks (pre-computed): - zone=hospital_zone: ... status=outside",
          "Mission: \"time_window_eval\": [... \"status\": \"outside\"]",
          "Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.",
          "Auto checks: - Night check: ... -> OK.",
          "Mission: \"night_eval\": {\"status\": \"OK\"}",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.",
          "No geofence constraints provided; treat geofence checks as outside by default."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "-120.0",
          "raw_unit": "m",
          "canonical_value": "-120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_min"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_max"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC3",
      "description": "夜间（23:00），医院区域外飞行，应允许（不在限制区域）",
      "expected_decision": "APPROVE",
      "llm_decision": "APPROVE",
      "mission": {
        "target_xyz": {
          "x": 0.0,
          "y": 200.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "time_of_day": "23:00",
        "night_eval": {
          "time_of_day": "23:00",
          "is_night": true,
          "light_required": true,
          "light_on": false,
          "training_required": true,
          "training_ok": false,
          "status": "OK",
          "reasons": [
            "Night check ignored because all time window statuses are outside."
          ]
        },
        "time_window_eval": [
          {
            "zone_id": "hospital_zone",
            "distance": 282.84,
            "radius": 150.0,
            "time": "23:00",
            "start": "22:00",
            "end": "06:00",
            "in_zone": false,
            "in_window": true,
            "status": "outside"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: -120.0m (SOP S012_time_window.jsonc)\n- Altitude: 0.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\nTime window checks (pre-computed):\n  - zone=hospital_zone: distance=282.84m radius=150.0m time=23:00 window=(22:00-06:00) in_zone=False in_window=True => status=outside\nTime window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Night check: time=23:00 is_night=True light_on=False training_ok=False -> OK.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 0.0, \"y\": 200.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"time_of_day\": \"23:00\", \"night_eval\": {\"time_of_day\": \"23:00\", \"is_night\": true, \"light_required\": true, \"light_on\": false, \"training_required\": true, \"training_ok\": false, \"status\": \"OK\", \"reasons\": [\"Night check ignored because all time window statuses are outside.\"]}, \"time_window_eval\": [{\"zone_id\": \"hospital_zone\", \"distance\": 282.84, \"radius\": 150.0, \"time\": \"23:00\", \"start\": \"22:00\", \"end\": \"06:00\", \"in_zone\": false, \"in_window\": true, \"status\": \"outside\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"APPROVE\",\n  \"reasons\": [\n    \"The mission altitude (50.0m) is permitted as per the retrieved altitude constraints.\",\n    \"All time window checks resulted in 'outside' status, therefore the hard constraint to REJECT based on 'inside' time window is not met.\",\n    \"The night check status is 'OK' because, as per the rules, night_eval violations are ignored when all time window statuses are 'outside'.\",\n    \"No auto_check statuses are 'VIOLATION'.\",\n    \"Geofence checks are treated as 'outside' by default as no geofence constraints were provided.\"\n  ],\n  \"citations\": [\n    \"Retrieved constraints: Altitude: 50.0m (SOP S012_time_window.jsonc)\",\n    \"Mission: {\\\"altitude_m\\\": 50.0}\",\n    \"Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT.\",\n    \"Mission: time_window_eval[0].status == \\\"outside\\\"\",\n    \"Time window rule: If all time_window_eval statuses are outside, you may ignore night_eval violations.\",\n    \"Mission: night_eval.status == \\\"OK\\\"\",\n    \"Mission: night_eval.reasons: [\\\"Night check ignored because all time window statuses are outside.\\\"]\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\",\n    \"Retrieved constraints: No geofence constraints provided; treat geofence checks as outside by default.\",\n    \"Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "APPROVE",
        "reasons": [
          "The mission altitude (50.0m) is permitted as per the retrieved altitude constraints.",
          "All time window checks resulted in 'outside' status, therefore the hard constraint to REJECT based on 'inside' time window is not met.",
          "The night check status is 'OK' because, as per the rules, night_eval violations are ignored when all time window statuses are 'outside'.",
          "No auto_check statuses are 'VIOLATION'.",
          "Geofence checks are treated as 'outside' by default as no geofence constraints were provided."
        ],
        "citations": [
          "Retrieved constraints: Altitude: 50.0m (SOP S012_time_window.jsonc)",
          "Mission: {\"altitude_m\": 50.0}",
          "Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT.",
          "Mission: time_window_eval[0].status == \"outside\"",
          "Time window rule: If all time_window_eval statuses are outside, you may ignore night_eval violations.",
          "Mission: night_eval.status == \"OK\"",
          "Mission: night_eval.reasons: [\"Night check ignored because all time window statuses are outside.\"]",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.",
          "Retrieved constraints: No geofence constraints provided; treat geofence checks as outside by default.",
          "Hard rules: Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "-120.0",
          "raw_unit": "m",
          "canonical_value": "-120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_min"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_max"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC4",
      "description": "夜间（23:00），医院区域内飞行，应拒绝（核心测试）",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 200.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "time_of_day": "23:00",
        "night_eval": {
          "time_of_day": "23:00",
          "is_night": true,
          "light_required": true,
          "light_on": false,
          "training_required": true,
          "training_ok": false,
          "status": "VIOLATION",
          "reasons": [
            "Night flight requires anti-collision light ON.",
            "Night flight requires pilot night training completed."
          ]
        },
        "time_window_eval": [
          {
            "zone_id": "hospital_zone",
            "distance": 0.0,
            "radius": 150.0,
            "time": "23:00",
            "start": "22:00",
            "end": "06:00",
            "in_zone": true,
            "in_window": true,
            "status": "inside"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: -120.0m (SOP S012_time_window.jsonc)\n- Altitude: 0.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\nTime window checks (pre-computed):\n  - zone=hospital_zone: distance=0.0m radius=150.0m time=23:00 window=(22:00-06:00) in_zone=True in_window=True => status=inside\nTime window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Night check: time=23:00 is_night=True light_on=False training_ok=False -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 200.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"time_of_day\": \"23:00\", \"night_eval\": {\"time_of_day\": \"23:00\", \"is_night\": true, \"light_required\": true, \"light_on\": false, \"training_required\": true, \"training_ok\": false, \"status\": \"VIOLATION\", \"reasons\": [\"Night flight requires anti-collision light ON.\", \"Night flight requires pilot night training completed.\"]}, \"time_window_eval\": [{\"zone_id\": \"hospital_zone\", \"distance\": 0.0, \"radius\": 150.0, \"time\": \"23:00\", \"start\": \"22:00\", \"end\": \"06:00\", \"in_zone\": true, \"in_window\": true, \"status\": \"inside\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"The mission is scheduled within a restricted time window for a hospital zone (23:00 is within 22:00-06:00) and is inside the zone radius.\",\n    \"The mission is a night flight (time=23:00) but violates night flight requirements: anti-collision light is not on, and pilot night training is not completed.\"\n  ],\n  \"citations\": [\n    \"Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in in restricted window), decision MUST be REJECT.\",\n    \"Mission: time_window_eval: status=inside for zone=hospital_zone.\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\",\n    \"Auto checks: Night check: VIOLATION (time=23:00 is_night=True light_on=False training_ok=False).\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "The mission is scheduled within a restricted time window for a hospital zone (23:00 is within 22:00-06:00) and is inside the zone radius.",
          "The mission is a night flight (time=23:00) but violates night flight requirements: anti-collision light is not on, and pilot night training is not completed."
        ],
        "citations": [
          "Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in in restricted window), decision MUST be REJECT.",
          "Mission: time_window_eval: status=inside for zone=hospital_zone.",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.",
          "Auto checks: Night check: VIOLATION (time=23:00 is_night=True light_on=False training_ok=False)."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "-120.0",
          "raw_unit": "m",
          "canonical_value": "-120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_min"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_max"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        }
      ]
    },
    {
      "test_case_id": "TC5",
      "description": "边界值测试（22:00禁飞开始），医院内，应拒绝",
      "expected_decision": "REJECT",
      "llm_decision": "REJECT",
      "mission": {
        "target_xyz": {
          "x": 200.0,
          "y": 0.0,
          "z": 50.0
        },
        "altitude_m": 50.0,
        "time_of_day": "22:00",
        "night_eval": {
          "time_of_day": "22:00",
          "is_night": true,
          "light_required": true,
          "light_on": false,
          "training_required": true,
          "training_ok": false,
          "status": "VIOLATION",
          "reasons": [
            "Night flight requires anti-collision light ON.",
            "Night flight requires pilot night training completed."
          ]
        },
        "time_window_eval": [
          {
            "zone_id": "hospital_zone",
            "distance": 0.0,
            "radius": 150.0,
            "time": "22:00",
            "start": "22:00",
            "end": "06:00",
            "in_zone": true,
            "in_window": true,
            "status": "inside"
          }
        ]
      },
      "prompt": "You are a dispatch AI. Decide APPROVE or REJECT with cited constraints.\nRetrieved constraints:\n- Altitude: -120.0m (SOP S012_time_window.jsonc)\n- Altitude: 0.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\n- Altitude: 50.0m (SOP S012_time_window.jsonc)\nTime window checks (pre-computed):\n  - zone=hospital_zone: distance=0.0m radius=150.0m time=22:00 window=(22:00-06:00) in_zone=True in_window=True => status=inside\nTime window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT. Do NOT answer UNCERTAIN when time_window_eval is present. If all time_window_eval statuses are outside, you may ignore night_eval violations.\nHard rules: if any auto_check status is VIOLATION, decision MUST be REJECT. Only if all auto_check statuses are OK and geofence checks are outside may you APPROVE.\nAuto checks:\n- Night check: time=22:00 is_night=True light_on=False training_ok=False -> VIOLATION.\nNo geofence constraints provided; treat geofence checks as outside by default.\nMission: {\"target_xyz\": {\"x\": 200.0, \"y\": 0.0, \"z\": 50.0}, \"altitude_m\": 50.0, \"time_of_day\": \"22:00\", \"night_eval\": {\"time_of_day\": \"22:00\", \"is_night\": true, \"light_required\": true, \"light_on\": false, \"training_required\": true, \"training_ok\": false, \"status\": \"VIOLATION\", \"reasons\": [\"Night flight requires anti-collision light ON.\", \"Night flight requires pilot night training completed.\"]}, \"time_window_eval\": [{\"zone_id\": \"hospital_zone\", \"distance\": 0.0, \"radius\": 150.0, \"time\": \"22:00\", \"start\": \"22:00\", \"end\": \"06:00\", \"in_zone\": true, \"in_window\": true, \"status\": \"inside\"}]}\nDecide and cite which constraints are satisfied/violated. Respond with JSON:\n{ \"decision\": \"APPROVE|REJECT|CONDITIONAL|UNCERTAIN\", \"reasons\": [...], \"citations\": [...] }",
      "llm_raw": "```json\n{\n  \"decision\": \"REJECT\",\n  \"reasons\": [\n    \"Mission is scheduled within a restricted hospital zone during its active time window (22:00-06:00).\",\n    \"Night check resulted in a VIOLATION due to missing anti-collision lights and uncompleted night training for a night flight.\"\n  ],\n  \"citations\": [\n    \"Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT.\",\n    \"Time window checks (pre-computed): zone=hospital_zone: distance=0.0m radius=150.0m time=22:00 window=(22:00-06:00) in_zone=True in_window=True => status=inside\",\n    \"Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.\",\n    \"Auto checks: Night check: time=22:00 is_night=True light_on=False training_ok=False -> VIOLATION.\"\n  ]\n}\n```",
      "llm_parsed": {
        "decision": "REJECT",
        "reasons": [
          "Mission is scheduled within a restricted hospital zone during its active time window (22:00-06:00).",
          "Night check resulted in a VIOLATION due to missing anti-collision lights and uncompleted night training for a night flight."
        ],
        "citations": [
          "Time window rule (hard constraint): if ANY time_window_eval status == inside (in zone AND in restricted window), decision MUST be REJECT.",
          "Time window checks (pre-computed): zone=hospital_zone: distance=0.0m radius=150.0m time=22:00 window=(22:00-06:00) in_zone=True in_window=True => status=inside",
          "Hard rules: if any auto_check status is VIOLATION, decision MUST be REJECT.",
          "Auto checks: Night check: time=22:00 is_night=True light_on=False training_ok=False -> VIOLATION."
        ]
      },
      "retrieved_constraints": [
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "-120.0",
          "raw_unit": "m",
          "canonical_value": "-120.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_min"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "0.0",
          "raw_unit": "m",
          "canonical_value": "0.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_scenario_parameters_restricted_zone_height_max"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        },
        {
          "concept": "Altitude",
          "source_type": "SOP",
          "source_ref": "S012_time_window.jsonc",
          "raw_value": "50.0",
          "raw_unit": "m",
          "canonical_value": "50.0",
          "canonical_unit": "m",
          "file": "/Users/zhangyunshi/Desktop/实习/airsim/LAE-GPT/scenarios/basic/S012_time_window.jsonc",
          "constraint_id": "S012_time_window_test_cases_test_points_target_position_altitude"
        }
      ]
    }
  ]
}